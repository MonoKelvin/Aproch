<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Node Widget</title>
    <link rel="stylesheet" href="css/style.default.css">
    <!-- <link rel="stylesheet" href="vendor/bootstrap-4.3.1/css/bootstrap.min.css"> -->
</head>

<body>
    <aproch-flow-view id="fv_1" name="flow view" class="flow-view">
    </aproch-flow-view>

    <script type="text/javascript" src="./vendor/jquery/jquery-3.4.1.min.js"></script>
    <script type="module">
        // import * as a from './core/TypeConverter.js'
        import { ALabelWidget, AInputNumberWidget } from './core/AWidget.js'
        import { AFlowView, ANode, AConnection, AInterface, APort } from './core/Aproch.js'

        //var FVManager = [];
        const CurrentFV = document.querySelector('#fv_1');

        $(document).ready(function () {
            // 防止按下(F5、Ctrl+R、Ctrl+Shift+R)刷新
            window.onkeydown = function (e) {
                var ev = window.event || e;
                var code = ev.keyCode || ev.which;
                if (code == 82 && (ev.metaKey || ev.ctrlKey)) {
                    return false;
                }
            }

            customElements.define('aproch-label-widget', ALabelWidget);
            customElements.define('aproch-input-number', AInputNumberWidget);
            customElements.define('aproch-flow-view', AFlowView);
            customElements.define('aproch-node', ANode);
            customElements.define('aproch-interface', AInterface);
            customElements.define('aproch-port', APort);
            customElements.define('aproch-connection', AConnection);

            // addNodeTest('#fv_1', 100, 100);
            // addNodeTest('#fv_1', 500, 100);
            for (var i = 0; i < 1; i++) {
                addNodeTest(Math.floor(Math.random() * 1000), Math.floor(Math.random() * 1000));
            }
        });

        function addNodeTest(x = 100, y = 100) {

            let node = new ANode(CurrentFV, x, y, "My Node");

            let itf = new AInterface(node, true, true);
            let itf2 = new AInterface(node, true, true);

            let label = new ALabelWidget('label');
            let input = new AInputNumberWidget('输入控件');

            itf.setWidget(label);
            itf2.setWidget(input);
        }
    </script>
</body>

</html>